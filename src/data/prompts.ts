// 公文格式指南接口
export interface DocFormatGuide {
  fontFamily: string;      // 字体
  fontSize: string;        // 字号
  lineSpacing: string;     // 行距
  paragraphSpacing: string;// 段落间距
  indentation: string;     // 缩进
  alignment: string;       // 对齐方式
  marginSettings: string;  // 页边距设置
}

// 公文格式指南
export const documentFormatGuide: DocFormatGuide = {
  fontFamily: "正文使用仿宋_GB2312字体，标题使用方正小标宋简体，一级标题使用黑体，二级标题使用楷体",
  fontSize: "标题使用小一号字(22pt)，一级标题使用三号字(16pt)，二级标题使用小三号字(15pt)，正文使用三号字(16pt)",
  lineSpacing: "固定值28磅",
  paragraphSpacing: "段前0行，段后0行",
  indentation: "首行缩进2字符",
  alignment: "标题居中，正文两端对齐",
  marginSettings: "上下页边距为2.54厘米，左右页边距为3.18厘米"
};

// 根据文档类型和子类型获取提示词模板
export function getPromptTemplate(type: string, subtype: string): string {
  const templates: Record<string, Record<string, string>> = {
    official: {
      notice: `请帮我生成一份正式通知公文，严格按照中国政府机关公文格式标准撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 主送单位：顶格写在标题下方，仿宋_GB2312字体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 落款：右对齐，包括单位名称和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应简明扼要地概括通知的主要内容，一般为"关于...的通知"
2. 主送单位：指明接收通知的单位
3. 正文：
   - 开头部分：说明发布通知的背景、依据和目的
   - 中间部分：详细说明通知的具体内容、要求和相关规定
   - 结尾部分：提出贯彻落实的要求，并视情况抄送有关单位
4. 落款：发文单位名称(加盖公章)和成文日期

### 语言风格
- 使用规范公文语言，准确、简明、庄重
- 多用短句，避免长篇累牍
- 用词严谨，表述清晰，逻辑性强
- 使用第三人称，避免使用第一人称

请确保内容真实可信、逻辑严密，按照公文规范编写，避免口语化表达。`,
      
      announcement: `请帮我生成一份正式公告公文，严格按照中国政府机关公文格式标准撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 落款：右对齐，包括单位名称和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应简明扼要地概括公告的主要内容，一般为"关于...的公告"
2. 正文：
   - 开头部分：说明公告的目的和依据
   - 中间部分：详细说明公告的具体内容，可分条列出
   - 结尾部分：说明公告的有效期限、执行要求等
3. 落款：发文单位名称(加盖公章)和发布日期

### 语言风格
- 使用规范公文语言，庄重、严肃
- 表述准确无误，避免歧义
- 内容简明扼要，层次清晰
- 用词严谨，表达清晰，具有权威性和指导性

公告是面向社会公开发布的，请确保内容严谨清晰，具有法律效力和权威性。`,
      
      opinion: `请帮我生成一份正式意见类公文，严格按照中国政府机关公文格式标准撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 主送单位：顶格写在标题下方，仿宋_GB2312字体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 落款：右对齐，包括单位名称和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应简明扼要地概括意见的主要内容，一般为"关于...的意见"
2. 主送单位：指明接收意见的单位
3. 正文：
   - 开头部分：说明提出意见的背景、依据和目的
   - 中间部分：分条列出具体意见和建议，每条意见应有具体的论证和依据
   - 结尾部分：总结意见的主要目的和预期效果
4. 落款：发文单位名称(加盖公章)和成文日期

### 语言风格
- 使用规范公文语言，准确、严谨、客观
- 论证充分，有理有据
- 建议明确具体，可操作性强
- 避免主观臆断，保持公正立场

请确保意见具有前瞻性、科学性和可行性，为决策提供有价值的参考。`,
      
      reply: `请帮我生成一份正式批复类公文，严格按照中国政府机关公文格式标准撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 主送单位：顶格写在标题下方，仿宋_GB2312字体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 落款：右对齐，包括单位名称和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应简明扼要地概括批复的主要内容，一般为"关于...的批复"
2. 主送单位：指明接收批复的单位
3. 正文：
   - 开头部分：说明批复所针对的请示公文及其主要内容
   - 中间部分：明确表明批复意见（同意或不同意），并说明理由和依据
   - 结尾部分：提出有关要求或需要注意的事项
4. 落款：发文单位名称(加盖公章)和成文日期

### 语言风格
- 使用规范公文语言，简明扼要，清晰准确
- 态度明确，决定性强
- 表述严谨，避免歧义
- 针对性强，直接回应请示事项

批复是对下级机关请示的正式答复，具有指导性和权威性，请确保内容明确、依据充分、表述准确。`
    },
    report: {
      work_report: `请帮我生成一份专业的工作报告，严格按照中国单位工作报告规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 落款：右对齐，包括撰写人/单位名称和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确报告主题和时间范围，如"XX部门2023年度工作报告"
2. 前言：简要说明报告背景、目的和范围
3. 主体部分：
   - 工作开展情况：详细描述已完成的工作内容、实施过程
   - 成果与成效：用数据和事实说明取得的成绩和效果
   - 存在问题与不足：客观分析工作中存在的问题和困难
   - 经验与体会：总结工作中的经验教训和体会感悟
4. 下一步工作计划：对未来工作的规划和展望
5. 结语：总结全文，提出期望或号召
6. 落款：报告撰写单位/个人及日期

### 语言风格
- 使用规范公文语言，客观、准确、清晰
- 数据详实，有理有据
- 逻辑性强，条理清晰
- 用词严谨，避免口语化和感情色彩过重的表达

请确保报告内容真实可信、全面系统、重点突出，能够客观反映工作情况和成效。`,
      
      research_report: `请帮我生成一份专业的调研报告，严格按照调研报告规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 图表：有标题和编号，居中放置
- 落款：右对齐，包括调研单位/团队和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确调研主题，如"关于XX问题的调研报告"
2. 前言：
   - 调研背景：说明开展调研的时代背景、现实意义
   - 调研目的：明确调研要解决的主要问题
   - 调研方法：说明采用的调研方式（问卷、访谈、实地考察等）
3. 主体部分：
   - 调研情况概述：调研的时间、地点、对象、范围等
   - 数据分析：详细呈现调研数据，并进行深入分析
   - 问题发现：列举调研中发现的主要问题和深层次原因
   - 对比分析：可与国内外先进经验进行对比
4. 结论部分：
   - 调研结论：对调研结果进行总结性概括
   - 对策建议：提出具体可行的解决方案或政策建议
5. 附件（如需）：调研问卷、重要数据表格等
6. 落款：调研单位/团队及日期

### 语言风格
- 使用规范学术语言，客观、严谨、精确
- 数据详实，图表清晰
- 分析深入，逻辑严密
- 建议具体，可操作性强

请确保调研内容真实可靠，分析透彻，建议具有针对性、创新性和可行性。`,
      
      summary_report: `请帮我生成一份专业的总结报告，严格按照总结报告规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 落款：右对齐，包括撰写单位/个人和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确总结主题和时间范围，如"XX项目2023年度工作总结报告"
2. 前言：简要说明总结的范围、目的和意义
3. 主体部分：
   - 工作回顾：回顾总结期内完成的主要工作
   - 成绩总结：重点突出取得的成绩和成效，用数据和事实说明
   - 问题分析：客观分析工作中存在的问题和不足
   - 经验教训：深入总结工作中值得肯定的经验和教训
4. 结论部分：
   - 总体评价：对总结期内工作的整体评价
   - 后续工作方向：提出下一步工作的思路和重点
5. 落款：撰写单位/个人及日期

### 语言风格
- 使用规范公文语言，客观、全面、准确
- 实事求是，不夸大成绩，不回避问题
- 数据详实，有理有据
- 内容全面，重点突出，层次分明

请确保总结内容真实可信、分析深入、经验提炼到位，能够为今后工作提供有益借鉴。`,
      
      inspection_report: `请帮我生成一份专业的考察报告，严格按照考察报告规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 落款：右对齐，包括考察单位/团队和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确考察主题，如"关于赴XX考察学习的报告"
2. 前言：
   - 考察背景：说明开展考察的目的和意义
   - 考察概况：考察的时间、地点、参与人员、考察对象等
3. 主体部分：
   - 考察内容：详细描述考察的具体内容和过程
   - 主要发现：客观记述考察中的重要发现和印象深刻的方面
   - 情况分析：对考察对象的情况进行深入分析和评价
   - 对比思考：将考察对象与自身情况进行对比分析
4. 结论部分：
   - 体会与启示：总结从考察中获得的主要启示和体会
   - 建议与思考：结合实际提出可借鉴和应用的建议
5. 附件（如需）：考察照片、重要材料等
6. 落款：考察单位/团队及日期

### 语言风格
- 使用规范公文语言，客观、详实、生动
- 描述准确，重点突出
- 分析深入，见解独到
- 启示明确，建议可行

请确保考察内容真实可靠，描述生动具体，分析深入透彻，启示和建议切实可行。`
    },
    plan: {
      work_plan: `请帮我生成一份专业的工作计划，严格按照工作计划规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 表格：如有时间表或进度安排，使用规范表格呈现
- 落款：右对齐，包括计划制定单位/个人和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确计划主题和时间范围，如"XX部门2023年度工作计划"
2. 前言：
   - 编制背景：说明制定计划的背景和依据
   - 总体目标：明确计划期内要达成的总体目标
3. 主体部分：
   - 工作重点：列出计划期内的重点工作任务
   - 具体任务：详细描述每项任务的内容、目标和要求
   - 实施步骤：明确任务实施的具体步骤和方法
   - 时间节点：制定详细的时间表，明确各任务的起止时间
   - 责任分工：明确各任务的责任部门和责任人
4. 保障措施：
   - 组织保障：确保计划顺利实施的组织措施
   - 制度保障：相关制度建设和保障措施
   - 资源保障：人力、物力、财力等资源保障措施
5. 预期效果：计划实施后预期达到的效果
6. 落款：计划制定单位/个人及日期

### 语言风格
- 使用规范公文语言，清晰、准确、简洁
- 目标具体，可量化，有明确时间限制
- 任务明确，责任清晰
- 措施具体，可操作性强

请确保计划内容切实可行、目标明确、措施得力、责任到人，能够有效指导实际工作。`,
      
      project_plan: `请帮我生成一份专业的项目计划，严格按照项目管理规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 图表：甘特图、网络图、资源分配表等项目管理图表
- 落款：右对齐，包括计划制定团队/个人和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确项目名称，如"XX项目实施计划"
2. 项目概述：
   - 项目背景：项目立项的背景和意义
   - 项目目标：明确项目要达成的具体目标（SMART原则）
   - 项目范围：明确项目的工作范围和边界
3. 主体部分：
   - 工作分解结构(WBS)：将项目分解为可管理的工作包
   - 进度计划：详细的时间安排，包括里程碑和关键节点
   - 资源计划：人力、设备、材料等资源的配置计划
   - 成本预算：项目各阶段、各部分的成本估算
   - 质量管理：确保项目质量的措施和标准
   - 风险管理：可能的风险及应对策略
4. 组织与管理：
   - 项目组织结构：项目团队的组成和职责分工
   - 沟通管理：项目内外部沟通机制和汇报制度
   - 变更管理：处理项目变更的流程和方法
5. 验收标准：项目成果的验收标准和流程
6. 附件：相关图表、预算表等
7. 落款：计划制定团队/个人及日期

### 语言风格
- 使用规范项目管理语言，专业、准确、清晰
- 目标具体，可衡量，有明确的时间和成本限制
- 计划详细，步骤清晰，责任明确
- 预见性强，考虑周全，风险管理完善

请确保计划内容专业、全面、可行，能够有效指导项目实施，防范风险，确保项目成功。`,
      
      implementation_plan: `请帮我生成一份专业的实施方案，严格按照实施方案规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 图表：如有流程图、组织结构图等，使用规范图表呈现
- 落款：右对齐，包括方案制定单位/团队和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确方案主题，如"XX工程实施方案"
2. 前言：
   - 方案背景：说明制定方案的背景和目的
   - 指导思想：阐述方案的指导思想和基本原则
   - 总体目标：明确方案实施的总体目标
3. 主体部分：
   - 实施内容：详细描述方案的具体实施内容
   - 技术路线：阐述实施的技术路线和方法
   - 组织架构：明确实施的组织结构和工作机制
   - 进度安排：制定详细的时间进度表
   - 人员分工：明确各环节的责任单位和责任人
4. 保障措施：
   - 组织保障：确保方案顺利实施的组织机制
   - 技术保障：相关技术支持和保障措施
   - 资金保障：资金预算和使用管理办法
   - 监督机制：实施过程的监督和评估机制
5. 风险评估与应对：可能存在的风险及应对措施
6. 预期效果：方案实施后预期达到的效果
7. 落款：方案制定单位/团队及日期

### 语言风格
- 使用规范公文语言，专业、准确、系统
- 内容具体，操作性强
- 步骤清晰，责任明确
- 考虑周全，措施得力

请确保方案内容科学合理、流程清晰、责任明确、措施有力，能够切实指导实际工作。`
    },
    summary: {
      work_summary: `请帮我生成一份专业的工作总结，严格按照工作总结规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 落款：右对齐，包括撰写人/单位和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确总结主题和时间范围，如"XX部门2023年度工作总结"
2. 前言：
   - 总结范围：明确总结的时间范围和工作范围
   - 总结目的：简要说明进行总结的目的和意义
3. 主体部分：
   - 工作回顾：全面回顾总结期内开展的主要工作
   - 工作成效：用数据和事实说明取得的成绩和效果
   - 存在问题：客观分析工作中存在的问题和不足
   - 原因分析：深入分析问题产生的原因
   - 经验教训：总结工作中的经验和教训
4. 今后打算：
   - 改进措施：针对存在问题提出具体改进措施
   - 工作计划：提出下一阶段的工作思路和计划
5. 结语：对全文进行总结，表达对未来工作的信心和决心
6. 落款：撰写人/单位及日期

### 语言风格
- 使用规范公文语言，客观、真实、准确
- 数据详实，有理有据
- 分析深入，见解独到
- 总结客观，不夸大成绩，不回避问题

请确保总结内容全面客观、分析深入、经验提炼到位，既能总结过去，又能指导未来。`,
      
      project_summary: `请帮我生成一份专业的项目总结，严格按照项目总结规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 副标题（如有）：居中，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."
- 图表：如有项目数据分析图表，使用规范图表呈现
- 落款：右对齐，包括项目团队/负责人和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确项目名称，如"XX项目总结报告"
2. 项目概况：
   - 项目背景：项目立项的背景和目的
   - 项目目标：项目预期达成的目标
   - 项目团队：项目参与人员及分工
   - 项目周期：项目的起止时间和主要阶段
3. 主体部分：
   - 实施过程：详细描述项目实施的各个阶段和过程
   - 目标完成情况：对照项目目标，分析完成情况
   - 资源使用情况：人力、物力、财力等资源的使用情况
   - 取得成效：项目带来的直接和间接成效
   - 存在问题：项目实施中遇到的问题和困难
   - 解决方案：针对问题采取的解决方案和效果
4. 经验总结：
   - 成功经验：项目成功的关键因素和经验
   - 失败教训：项目中的失误和教训
   - 创新点：项目中的创新和突破
5. 后续建议：对类似项目或后续工作的建议
6. 附件：相关数据、图表、文档等
7. 落款：项目团队/负责人及日期

### 语言风格
- 使用规范项目管理语言，客观、详实、专业
- 数据准确，事实清晰
- 分析深入，总结到位
- 建议具体，可操作性强

请确保总结内容真实客观、成效明确、经验提炼深刻，能为今后类似项目提供有价值的参考。`,
      
      meeting_minutes: `请帮我生成一份专业的会议纪要，严格按照会议纪要规范撰写。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 会议信息：左对齐，黑体，三号字(16pt)
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(二)"，三级标题用"1."
- 落款：右对齐，包括记录人和日期(YYYY年MM月DD日)

### 内容结构
1. 标题：应明确会议名称，如"XX项目启动会议纪要"
2. 会议基本信息：
   - 会议时间：精确到年月日时分
   - 会议地点：详细会议地点
   - 主持人：会议主持人姓名和职务
   - 参会人员：按照部门或职务排序列出
   - 记录人：会议记录人姓名
3. 主体部分：
   - 会议议程：会议的主要议程和议题
   - 会议内容：
     a. 领导讲话：重要领导的发言要点
     b. 议题讨论：各议题的讨论情况、不同意见
     c. 意见交流：参会人员的主要意见和建议
   - 会议决议：会议形成的决定和共识
   - 工作安排：会后需要开展的工作及责任分工
4. 下一步计划：
   - 后续工作安排：时间节点和负责人
   - 下次会议安排：如有下次会议，说明时间和主要内容
5. 会议总结：对会议进行简要总结
6. 附件：相关材料、文件等
7. 落款：记录人及日期

### 语言风格
- 使用规范会议记录语言，客观、准确、简洁
- 记录详实，重点突出
- 表述清晰，避免歧义
- 决议明确，责任清晰

请确保会议纪要内容完整准确、要点突出、决议明确，能够为参会人员和后续工作提供明确指导。`
    }
  };
  
  // 如果找不到特定类型和子类型的模板，返回通用模板
  if (!templates[type] || !templates[type][subtype]) {
    return `请帮我生成一份专业的文档，确保内容详实、结构清晰、语言规范。

### 格式要求
- 标题：居中，加粗，小一号字(22pt)，方正小标宋简体
- 正文：每段首行缩进2字符，仿宋_GB2312字体，三号字(16pt)
- 标题编号：一级标题用"一、"，二级标题用"(一)"，三级标题用"1."

### 内容要求
- 结构完整，层次分明
- 内容充实，论述有据
- 语言规范，表述清晰
- 重点突出，条理清楚

请按照专业文档的格式和要求进行撰写，确保内容真实可信、论述有力、结构合理。`;
  }
  
  return templates[type][subtype];
}

// 生成完整的提示词
export function generatePrompt(type: string, subtype: string, title: string, content?: string, requirements?: string): string {
  // 获取基础模板
  const promptTemplate = getPromptTemplate(type, subtype);
  
  // 添加文档格式指南
  let prompt = `${promptTemplate}\n\n### 文档格式指南
- 字体：${documentFormatGuide.fontFamily}
- 字号：${documentFormatGuide.fontSize}
- 行距：${documentFormatGuide.lineSpacing}
- 段落间距：${documentFormatGuide.paragraphSpacing}
- 缩进：${documentFormatGuide.indentation}
- 对齐方式：${documentFormatGuide.alignment}
- 页边距：${documentFormatGuide.marginSettings}\n\n`;
  
  // 添加标题
  prompt += `### 文档信息\n文档标题："${title}"\n`;
  
  // 添加内容描述（如果有）
  if (content && content.trim()) {
    prompt += `\n### 内容要点\n${content}\n`;
  }
  
  // 添加个性化要求（如果有）
  if (requirements && requirements.trim()) {
    prompt += `\n### 特殊要求\n${requirements}\n`;
  }
  
  // 添加输出格式要求
  prompt += `\n### 输出要求
1. 请使用Markdown格式输出，使用标准的标题格式(#、##、###等)
2. 请确保文档格式符合规范，内容专业、详尽、准确
3. 请根据文档类型和子类型特点组织内容结构
4. 请考虑实际应用场景，使文档具有实用性和可操作性`;
  
  return prompt;
} 